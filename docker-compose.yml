version: '3.8'

services:
  audio2hero:
    build: .
    container_name: audio2hero
    restart: unless-stopped
    ports:
      - "7860:7860"  # Gradio web interface
    volumes:
      # Mount inputs directory for audio files
      - ./inputs:/app/inputs:ro
      # Mount outputs directory for generated files
      - ./outputs:/app/outputs
      # Optional: Mount cache for model files (speeds up restarts)
      - ./cache:/root/.cache
    environment:
      - PYTHONUNBUFFERED=1
      - GRADIO_SERVER_NAME=0.0.0.0
      - GRADIO_SERVER_PORT=7860
      - OUTPUT_DIR=/app/outputs
    # Resource limits (adjust based on your server)
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 8G
        reservations:
          cpus: '2'
          memory: 4G

